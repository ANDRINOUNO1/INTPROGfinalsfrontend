{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet AddEditRequestComponent = class AddEditRequestComponent {\n  constructor(route, router, requestService, alertService) {\n    this.route = route;\n    this.router = router;\n    this.requestService = requestService;\n    this.alertService = alertService;\n    this.id = null;\n    this.request = {\n      type: 'Equipment',\n      items: []\n    };\n    this.errorMessage = '';\n  }\n  ngOnInit() {\n    this.id = Number(this.route.snapshot.paramMap.get('id'));\n    if (this.id) {\n      this.requestService.getById(this.id).subscribe({\n        next: data => this.request = data,\n        error: err => this.errorMessage = err\n      });\n    } else {\n      this.addItem(); // start with one item input\n    }\n  }\n  addItem() {\n    this.request.items.push({\n      name: '',\n      quantity: 1\n    });\n  }\n  removeItem(index) {\n    this.request.items.splice(index, 1);\n  }\n  save() {\n    if (!this.request.type || this.request.items.length === 0) {\n      this.errorMessage = 'Request type and at least one item are required.';\n      return;\n    }\n    const payload = {\n      ...this.request,\n      items: this.request.items.map(i => ({\n        itemName: i.name,\n        quantity: i.quantity\n      }))\n    };\n    if (this.id) {\n      this.requestService.update(this.id, payload).subscribe({\n        next: () => this.router.navigate(['/admin/requests']),\n        error: err => this.errorMessage = err\n      });\n    } else {\n      this.requestService.create(payload).subscribe({\n        next: res => {\n          const newId = res.id;\n          this.requestService.addItems(newId, payload.items).subscribe({\n            next: () => this.router.navigate(['/admin/requests']),\n            error: err => this.errorMessage = err\n          });\n        },\n        error: err => this.errorMessage = err\n      });\n    }\n  }\n  cancel() {\n    this.router.navigate(['/admin/requests']);\n  }\n};\nAddEditRequestComponent = __decorate([Component({\n  selector: 'app-add-edit-request',\n  templateUrl: './add-edit-request.component.html',\n  styleUrls: ['./add-edit-request.component.css']\n})], AddEditRequestComponent);\nexport { AddEditRequestComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}